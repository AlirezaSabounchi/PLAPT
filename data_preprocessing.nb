(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='WolframDesktop 13.2' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       161,          7]
NotebookDataLength[     11305,        272]
NotebookOptionsPosition[      9769,        239]
NotebookOutlinePosition[     10191,        255]
CellTagsIndexPosition[     10148,        252]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell[BoxData[
 RowBox[{"NotebookDirectory", "[", "]"}]], "Input",
 CellChangeTimes->{{3.9058858600164733`*^9, 3.9058859139119773`*^9}, {
  3.905885977332878*^9, 3.9058859790864096`*^9}},
 CellLabel->"In[13]:=",ExpressionUUID->"c0bf49d1-98b7-43bf-a2b7-86c2ad529908"],

Cell[BoxData["\<\"G:\\\\Other computers\\\\Home \
PC\\\\Programs\\\\Wolfram\\\\WELP-PLAPT\\\\\"\>"], "Output",
 CellChangeTimes->{
  3.9058858677630205`*^9, {3.905885910101745*^9, 3.9058859122278805`*^9}, {
   3.9058859777707644`*^9, 3.9058859794720793`*^9}},
 CellLabel->"Out[13]=",ExpressionUUID->"06d6d90d-3037-4964-af4b-6a4f79cfce4f"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"ImportPDBbindData", "[", "filePath_String", "]"}], ":=", 
  RowBox[{"Select", "[", 
   RowBox[{
    RowBox[{"Import", "[", "filePath", "]"}], ",", 
    RowBox[{"(*", 
     RowBox[{
      RowBox[{
      "remove", " ", "lines", " ", "that", " ", "start", " ", "with", " ", 
       "\"\<#\>\""}], " ", "-", " ", 
      RowBox[{"these", " ", "are", " ", "comments"}]}], "*)"}], 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"StringPart", "[", 
        RowBox[{
         RowBox[{"#", "[", 
          RowBox[{"[", "1", "]"}], "]"}], ",", "1"}], "]"}], "!=", 
       "\"\<#\>\""}], ")"}], "&"}]}], "]"}]}]], "Code",
 CellChangeTimes->{{3.9058855186506467`*^9, 3.9058855754299192`*^9}, {
   3.9058856189804325`*^9, 3.905885622719613*^9}, {3.905885696077506*^9, 
   3.9058856971863194`*^9}, 3.905885986092814*^9, {3.9058870867167177`*^9, 
   3.9058872237854414`*^9}, {3.905887260611139*^9, 3.905887264119791*^9}, {
   3.905887299456808*^9, 3.9058873496518564`*^9}, {3.905887438920206*^9, 
   3.9058875650906754`*^9}, {3.9058876245889654`*^9, 3.90588771460557*^9}, {
   3.9058877527599754`*^9, 3.9058878365226946`*^9}},
 CellLabel->"In[2]:=",ExpressionUUID->"dd07d808-5dbc-4979-875a-8fd15c450933"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"data", "=", 
  RowBox[{"ImportPDBbindData", "[", 
   RowBox[{
    RowBox[{"NotebookDirectory", "[", "]"}], "<>", 
    "\"\<\\\\data\\\\INDEX_refined_data.2020\>\""}], "]"}]}]], "Input",
 CellChangeTimes->{{3.906059256315873*^9, 3.906059259577405*^9}, {
  3.9060593199455814`*^9, 3.9060593613259177`*^9}, {3.9060603632557907`*^9, 
  3.906060364141203*^9}},
 CellLabel->"In[16]:=",ExpressionUUID->"7bac02ee-ba46-4d5d-a820-bc791668d264"],

Cell[BoxData[
 TemplateBox[<|"shortenedBoxes" -> TagBox[
     RowBox[{"{", 
       RowBox[{
         RowBox[{
          "{", "\"2r58  2.00  2007   2.00  Kd=10mM       // 2r58.pdf (MLY)\"",
            "}"}], ",", 
         RowBox[{
          "{", "\"3c2f  2.35  2008   2.00  Kd=10.1mM     // 3c2f.pdf (PRP)\"",
            "}"}], ",", 
         RowBox[{
          "{", "\"3g2y  1.31  2009   2.00  Ki=10mM       // 3g2y.pdf (GF4)\"",
            "}"}], ",", 
         TemplateBox[{"5310"}, "OutputSizeLimit`Skeleton"], ",", 
         RowBox[{
          "{", "\"1sl3  1.81  2004  11.85  Ki=1.4pM      // 1sl3.pdf (170)\"",
            "}"}], ",", 
         RowBox[{
          "{", "\"1ctu  2.30  1995  11.92  Ki=1.2pM      // 1ctu.pdf (ZEB)\"",
            "}"}], ",", 
         RowBox[{
          "{", "\"6e9a  1.22  2018  11.92  Ki=0.0012nM   // 6e7j.pdf (J0S)\"",
            "}"}]}], "}"}], Short[#, 8]& ], "line" -> 16, "sessionID" -> 
   33030769262004004965, "byteCount" -> 765896, "size" -> 8, "stored" -> 
   False, "expr" -> Missing["NotStored"], "wrap" -> OutputSizeLimit`Defer, 
   "version" -> 1|>,
  "OutputSizeLimitTemplate"]], "Output",
 CellChangeTimes->{{3.9060593428556004`*^9, 3.906059363522889*^9}, 
   3.906060365448068*^9},
 CellLabel->"Out[16]=",ExpressionUUID->"31c3f907-a37d-4880-a996-5af824daaea8"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"proteinIDs", "=", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"StringSplit", "[", 
       RowBox[{"#", "[", 
        RowBox[{"[", "1", "]"}], "]"}], "]"}], "[", 
      RowBox[{"[", "1", "]"}], "]"}], "&"}], "/@", "data"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.9060593670380583`*^9, 3.9060593911239643`*^9}, {
   3.9060594262874947`*^9, 3.9060594288073816`*^9}, 3.9060603710557084`*^9},
 CellLabel->"In[18]:=",ExpressionUUID->"2ab50d98-d627-4d3d-8898-990ef063b447"],

Cell[BoxData[
 RowBox[{
  RowBox[{"GetProteinLigandDataFromID", "[", 
   RowBox[{"directory_String", ",", "id_String"}], "]"}], ":=", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"Import", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"FileNames", "[", 
        RowBox[{"\"\<*protein.pdb\>\"", ",", 
         RowBox[{"FileNameJoin", "[", 
          RowBox[{"{", 
           RowBox[{"directory", ",", "id"}], "}"}], "]"}]}], "]"}], "[", 
       RowBox[{"[", "1", "]"}], "]"}], ",", "\"\<Sequence\>\""}], "]"}], ",", 
    RowBox[{
     RowBox[{
      RowBox[{"Import", "[", 
       RowBox[{
        RowBox[{"FileNames", "[", 
         RowBox[{"\"\<*.sdf\>\"", ",", 
          RowBox[{"FileNameJoin", "[", 
           RowBox[{"{", 
            RowBox[{"directory", ",", "id"}], "}"}], "]"}]}], "]"}], "[", 
        RowBox[{"[", "1", "]"}], "]"}], "]"}], "[", 
      RowBox[{"[", "1", "]"}], "]"}], "[", "\"\<SMILES\>\"", "]"}]}], 
   "}"}]}]], "Input",
 CellChangeTimes->{{3.905885625075739*^9, 3.9058857125383883`*^9}, 
   3.906059237834773*^9, {3.9060594756669874`*^9, 3.906059499671022*^9}, {
   3.9060595931659713`*^9, 3.906059597905801*^9}, {3.9060596623161106`*^9, 
   3.906059699815791*^9}, {3.9060597998107243`*^9, 3.9060599192959776`*^9}, {
   3.906060008715658*^9, 3.9060600370256667`*^9}, {3.906060114536357*^9, 
   3.9060601198457007`*^9}, {3.9060601723557234`*^9, 3.906060223755876*^9}, {
   3.9060602802757134`*^9, 3.9060603222667847`*^9}, {3.9060604779458704`*^9, 
   3.9060605274816995`*^9}, {3.9060605665109386`*^9, 
   3.9060605972358932`*^9}, {3.90606062939596*^9, 3.906060767856089*^9}, {
   3.906060849321049*^9, 3.9060608553458033`*^9}, {3.9060609564560604`*^9, 
   3.90606096970586*^9}, {3.906061024415976*^9, 3.9060610433297567`*^9}, {
   3.90606108823563*^9, 3.906061238735909*^9}, {3.9060612975360413`*^9, 
   3.9060613513623753`*^9}, {3.9060614278860397`*^9, 
   3.9060614284859247`*^9}, {3.9060614587059603`*^9, 
   3.9060614645861464`*^9}, {3.9060615089057927`*^9, 
   3.9060615180669684`*^9}, {3.9060615906261005`*^9, 3.9060616139327507`*^9}},
 CellLabel->"In[64]:=",ExpressionUUID->"8d3f2b9a-4538-41fb-8fe6-4766e1f8de97"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"GetProteinLigandDataFromID", "[", 
  RowBox[{
  "\"\<C:\\\\Users\\\\tatwo\\\\Downloads\\\\refined-set\>\"", ",", 
   "\"\<6uh0\>\""}], "]"}]], "Input",
 CellChangeTimes->{{3.906060325157474*^9, 3.906060327631171*^9}, {
   3.9060603897855835`*^9, 3.9060604020159197`*^9}, {3.906060780646019*^9, 
   3.9060607821458387`*^9}, {3.9060608173658905`*^9, 
   3.9060608943460665`*^9}, {3.9060609314861603`*^9, 3.9060609756558924`*^9}, 
   3.906061205487851*^9},
 CellLabel->"In[65]:=",ExpressionUUID->"3a56d7af-4da8-4c05-9b8b-2bdf29b9ddeb"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"\<\"\
HWGYGKHNGPEHWHKDFPIAKGERQSPVDIDTHTAKYDPSLKPLSVSYDQATSLRILNNGHAFNVEFDDSQDKAVLKG\
GPLDGTYRLIQFHFHWGSLDGQGSEHTVDKKKYAAELHLVHWNT\"\>", 
     ",", "\<\"\
KYGDFGKAVQQPDGLAVLGIFLKVGSAKPGLQKVVDVLDSIKTKGKSADFTNFDPRGLLPESLDYWTYPGSLTTPPLL\
ECVTWIVLKEPISVSSEQVLKFRKLNFNGEGEPEELMVDNWRPAQPLKNRQIKASFK\"\>"}], "}"}], 
   ",", "\<\"N1([H])S(=O)(=O)c2c([H])c([H])c([H])c([H])c2N(C([H])([H])[H])C1=\
O\"\>"}], "}"}]], "Output",
 CellChangeTimes->{
  3.9060604065058966`*^9, {3.906060733783245*^9, 3.90606074693643*^9}, {
   3.9060608271144285`*^9, 3.9060608851909485`*^9}, {3.906060933636004*^9, 
   3.90606097655632*^9}, {3.906061162560727*^9, 3.906061232647951*^9}, {
   3.906061334386118*^9, 3.9060613545557547`*^9}, 3.9060614309056406`*^9, 
   3.9060614682958145`*^9, 3.906061511511054*^9, {3.9060615962073293`*^9, 
   3.9060616165759573`*^9}},
 CellLabel->"Out[65]=",ExpressionUUID->"13501e22-9982-4f82-8806-593863e7a630"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"FileNames", "[", 
  RowBox[{"All", ",", 
   RowBox[{"FileNameJoin", "[", 
    RowBox[{"{", 
     RowBox[{
     "\"\<C:\\\\Users\\\\tatwo\\\\Downloads\\\\refined-set\\\\\>\"", ",", 
      "\"\<6uh0\>\""}], "}"}], "]"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.906060247931075*^9, 3.9060603032756157`*^9}, {
  3.9060603347962427`*^9, 
  3.906060335876152*^9}},ExpressionUUID->"a0f0ca27-49de-4a70-a477-\
515f8b77b3a5"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"\<\"C:\\\\Users\\\\tatwo\\\\Documents\\\\refined-set\\\\6uh0\\\\\
6uh0_ligand.mol2\"\>", 
   ",", "\<\"C:\\\\Users\\\\tatwo\\\\Documents\\\\refined-set\\\\6uh0\\\\6uh0_\
ligand.sdf\"\>", 
   ",", "\<\"C:\\\\Users\\\\tatwo\\\\Documents\\\\refined-set\\\\6uh0\\\\6uh0_\
pocket.pdb\"\>", 
   ",", "\<\"C:\\\\Users\\\\tatwo\\\\Documents\\\\refined-set\\\\6uh0\\\\6uh0_\
protein.pdb\"\>"}], "}"}]], "Output",
 CellChangeTimes->{{3.9060602676360674`*^9, 3.9060603035517654`*^9}},
 CellLabel->"Out[14]=",ExpressionUUID->"e2f2f163-acfc-41dc-b417-981aafb3d27c"]
}, Open  ]],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.905885584912666*^9, 3.9058855862235384`*^9}, 
   3.905885616271527*^9},ExpressionUUID->"be812607-5094-4f5b-ad97-\
5d89f1a8ebdb"]
},
WindowSize->{571.8, 596.4},
WindowMargins->{{Automatic, 12}, {Automatic, 21.599999999999998`}},
FrontEndVersion->"13.2 for Microsoft Windows (64-bit) (January 31, 2023)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"f3566f1a-9a07-4db6-a77f-b038dbe4cb1f"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[583, 22, 265, 4, 28, "Input",ExpressionUUID->"c0bf49d1-98b7-43bf-a2b7-86c2ad529908"],
Cell[851, 28, 338, 5, 32, "Output",ExpressionUUID->"06d6d90d-3037-4964-af4b-6a4f79cfce4f"]
}, Open  ]],
Cell[1204, 36, 1239, 27, 50, "Code",ExpressionUUID->"dd07d808-5dbc-4979-875a-8fd15c450933"],
Cell[CellGroupData[{
Cell[2468, 67, 458, 9, 48, "Input",ExpressionUUID->"7bac02ee-ba46-4d5d-a820-bc791668d264"],
Cell[2929, 78, 1323, 29, 180, "Output",ExpressionUUID->"31c3f907-a37d-4880-a996-5af824daaea8"]
}, Open  ]],
Cell[4267, 110, 513, 12, 28, "Input",ExpressionUUID->"2ab50d98-d627-4d3d-8898-990ef063b447"],
Cell[4783, 124, 2149, 43, 143, "Input",ExpressionUUID->"8d3f2b9a-4538-41fb-8fe6-4766e1f8de97"],
Cell[CellGroupData[{
Cell[6957, 171, 556, 10, 48, "Input",ExpressionUUID->"3a56d7af-4da8-4c05-9b8b-2bdf29b9ddeb"],
Cell[7516, 183, 985, 19, 166, "Output",ExpressionUUID->"13501e22-9982-4f82-8806-593863e7a630"]
}, Open  ]],
Cell[CellGroupData[{
Cell[8538, 207, 440, 11, 67, "Input",ExpressionUUID->"a0f0ca27-49de-4a70-a477-515f8b77b3a5"],
Cell[8981, 220, 592, 11, 90, "Output",ExpressionUUID->"e2f2f163-acfc-41dc-b417-981aafb3d27c"]
}, Open  ]],
Cell[9588, 234, 177, 3, 28, "Input",ExpressionUUID->"be812607-5094-4f5b-ad97-5d89f1a8ebdb"]
}
]
*)

